class MaquinaDeCafe:
    def _init_(self):
        self.monedas_insertadas = 0
        self.contador_ventas = 0
        self.stock_maximo = 30  # Stock máximo por café
        self.stock = {
            '1': {'nombre': "Espresso", 'cantidad': 30},
            '2': {'nombre': "Americano", 'cantidad': 30},
            '3': {'nombre': "Capuchino", 'cantidad': 30},
            '4': {'nombre': "Latte", 'cantidad': 30},
            '5': {'nombre': "Mocha", 'cantidad': 30}
        }
    
    def insertar_moneda(self):
        self.monedas_insertadas += 1
        print(f"\n[Moneda virtual insertada. Monedas disponibles: {self.monedas_insertadas}]")
        self.mostrar_menu_cafes()
    
    def mostrar_menu_principal(self):
        print("\n=== MENÚ PRINCIPAL ===")
        print("0. Insertar moneda")
        print("7. Modo administrador")
        print("s. Salir")
        print("=====================")
    
    def mostrar_menu_cafes(self):
        print("\n=== ELIJA SU CAFÉ ===")
        for opcion, datos in self.stock.items():
            if datos['cantidad'] > 0:
                print(f"{opcion}. {datos['nombre']}")
            else:
                print(f"{opcion}. {datos['nombre']} - AGOTADO")
        print("====================")
    
    def verificar_stock(self):
        print("\n=== STOCK DE CAFÉS ===")
        for opcion, datos in self.stock.items():
            estado = f"{datos['nombre']}: {datos['cantidad']}/{self.stock_maximo}"
            if datos['cantidad'] <= 10:
                estado += " - ¡NECESITA RECARGA!"
            print(estado)
        print("======================")
        
        self.verificar_alertas_recarga()
    
    def verificar_alertas_recarga(self):
        alertas = [datos for datos in self.stock.values() if datos['cantidad'] <= 10]
        if alertas:
            print("\n¡ALERTA DE INVENTARIO BAJO!")
            for cafe in alertas:
                print(f"- {cafe['nombre']} (Stock actual: {cafe['cantidad']})")
    
    def recargar_cafe(self, opcion):
        datos = self.stock[opcion]
        cantidad_actual = datos['cantidad']
        max_recarga = self.stock_maximo - cantidad_actual
        
        if max_recarga <= 0:
            print(f"\n[¡{datos['nombre']} ya tiene stock máximo ({self.stock_maximo})!]")
            return
        
        print(f"\nRecargando {datos['nombre']}")
        print(f"Stock actual: {cantidad_actual}/{self.stock_maximo}")
        print(f"Puede agregar hasta {max_recarga} unidades")
        
        try:
            cantidad = int(input("Ingrese cantidad a recargar: "))
            if cantidad <= 0:
                print("\n[La cantidad debe ser mayor a 0]")
            elif cantidad > max_recarga:
                print(f"\n[¡Excede el stock máximo! Máximo permitido: {max_recarga}]")
            else:
                self.stock[opcion]['cantidad'] += cantidad
                print(f"\n[¡Recarga exitosa! Nuevo stock: {self.stock[opcion]['cantidad']}/{self.stock_maximo}]")
        except ValueError:
            print("\n[Error: Ingrese un número válido]")
        except KeyboardInterrupt:
            print("\n[Operación cancelada por el usuario]")
        except EOFError:
            print("\n[Error de entrada inesperado]")
    
    def seleccionar_cafe(self, opcion):
        if self.monedas_insertadas <= 0:
            print("\n[No tiene monedas. Inserte una moneda primero (presione 0).]")
            return False
        
        if opcion in self.stock:
            if self.stock[opcion]['cantidad'] > 0:
                cafe = self.stock[opcion]['nombre']
                self.stock[opcion]['cantidad'] -= 1
                self.contador_ventas += 1
                self.monedas_insertadas -= 1
                
                print("\n=================================")
                print(f"  ¡Gracias por su compra!")
                print(f"  Café seleccionado: {cafe}")
                print("=================================")
                
                if self.stock[opcion]['cantidad'] == 10:
                    print(f"\n[ALERTA: Quedan solo 10 unidades de {cafe}. Por favor recargar.]")
                
                return True
            else:
                print(f"\n[Lo sentimos, {self.stock[opcion]['nombre']} está agotado.]")
                return False
        else:
            print("\n[Opción no válida. Por favor seleccione un café del menú.]")
            return False

def main():
    maquina = MaquinaDeCafe()

    print("\nBIENVENIDO A LA MÁQUINA DE CAFÉ VIRTUAL")
    
    while True:
        try:
            maquina.mostrar_menu_principal()
            entrada = input("\nSeleccione una opción: ").lower()
            
            if entrada == 's':
                print("\nGracias por usar la máquina de café. ¡Hasta pronto!")
                break
            elif entrada == '0':
                maquina.insertar_moneda()
                
                while maquina.monedas_insertadas > 0:
                    try:
                        opcion_cafe = input("\nSeleccione su café (1-5) o 'x' para salir: ").lower()
                        
                        if opcion_cafe == 'x':
                            break
                        elif opcion_cafe in ['1', '2', '3', '4', '5']:
                            if maquina.seleccionar_cafe(opcion_cafe):
                                if maquina.monedas_insertadas > 0:
                                    print(f"\nTiene {maquina.monedas_insertadas} moneda(s) restante(s).")
                                    continuar = input("¿Desea comprar otro café? (s/n): ").lower()
                                    if continuar != 's':
                                        break
                                else:
                                    print("\n[No tiene monedas restantes.]")
                                    input("Presione Enter para continuar...")
                                    break
                        else:
                            print("\n[Opción no válida. Intente nuevamente.]")
                    except KeyboardInterrupt:
                        print("\n[Operación cancelada por el usuario]")
                        break
                    except EOFError:
                        print("\n[Error de entrada inesperado]")
                        break
            elif entrada == '7':
                try:
                    contraseña = input("\nIngrese la contraseña de administrador: ")
                    if contraseña == "34":
                        while True:
                            try:
                                maquina.verificar_stock()
                                
                                print("\n=== OPCIONES ADMINISTRADOR ===")
                                print("1. Recargar café con stock bajo")
                                print("2. Recargar café específico")
                                print("3. Ver estadísticas completas")
                                print("4. Volver al menú principal")
                                opcion_admin = input("Seleccione una opción: ")
                                
                                if opcion_admin == '1':
                                    cafes_bajo_stock = [opcion for opcion, datos in maquina.stock.items() if datos['cantidad'] <= 10]
                                    if cafes_bajo_stock:
                                        print("\n=== CAFÉS PARA RECARGAR ===")
                                        for opcion in cafes_bajo_stock:
                                            datos = maquina.stock[opcion]
                                            print(f"{opcion}. {datos['nombre']} (Stock: {datos['cantidad']})")
                                        
                                        opcion_recarga = input("\nSeleccione café a recargar (1-5) o 'x' para cancelar: ")
                                        if opcion_recarga in cafes_bajo_stock:
                                            maquina.recargar_cafe(opcion_recarga)
                                        elif opcion_recarga != 'x':
                                            print("\n[Opción no válida o café no necesita recarga]")
                                    else:
                                        print("\n[No hay cafés con stock bajo]")
                                elif opcion_admin == '2':
                                    print("\n=== TODOS LOS CAFÉS ===")
                                    for opcion, datos in maquina.stock.items():
                                        print(f"{opcion}. {datos['nombre']} (Stock: {datos['cantidad']}/{maquina.stock_maximo})")
                                    
                                    opcion_recarga = input("\nSeleccione café a recargar (1-5) o 'x' para cancelar: ")
                                    if opcion_recarga in maquina.stock.keys():
                                        maquina.recargar_cafe(opcion_recarga)
                                    elif opcion_recarga != 'x':
                                        print("\n[Opción no válida]")
                                elif opcion_admin == '3':
                                    print("\n=== ESTADÍSTICAS COMPLETAS ===")
                                    print(f"Total de cafés vendidos: {maquina.contador_ventas}")
                                    maquina.verificar_stock()
                                elif opcion_admin == '4':
                                    break
                                else:
                                    print("\n[Opción no válida]")
                            except KeyboardInterrupt:
                                print("\n[Operación cancelada por el usuario]")
                                break
                            except EOFError:
                                print("\n[Error de entrada inesperado]")
                                break
                    else:
                        print("\n[Contraseña incorrecta. Acceso denegado.]")
                except KeyboardInterrupt:
                    print("\n[Operación cancelada por el usuario]")
                except EOFError:
                    print("\n[Error de entrada inesperado]")
            else:
                print("\n[Opción no válida. Intente nuevamente.]")
        except KeyboardInterrupt:
            print("\n\n[Operación cancelada por el usuario. Saliendo...]")
            break
        except EOFError:
            print("\n\n[Error de entrada inesperado. Saliendo...]")
            break

if _name_ == "_main_":
    main()
